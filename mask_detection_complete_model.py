{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "criminal-oracle",
   "metadata": {},
   "outputs": [],
   "source": [
    "# import the necessary packages\n",
    "from tensorflow.keras.preprocessing.image import ImageDataGenerator\n",
    "from tensorflow.keras.applications import MobileNetV2\n",
    "from tensorflow.keras.layers import AveragePooling2D\n",
    "from tensorflow.keras.layers import Dropout\n",
    "from tensorflow.keras.layers import Flatten\n",
    "from tensorflow.keras.layers import Dense\n",
    "from tensorflow.keras.layers import Input\n",
    "from tensorflow.keras.models import Model\n",
    "from tensorflow.keras.optimizers import Adam\n",
    "from tensorflow.keras.applications.mobilenet_v2 import preprocess_input\n",
    "from tensorflow.keras.preprocessing.image import img_to_array\n",
    "from tensorflow.keras.preprocessing.image import load_img\n",
    "from tensorflow.keras.utils import to_categorical\n",
    "from sklearn.preprocessing import LabelBinarizer\n",
    "from sklearn.model_selection import train_test_split\n",
    "from sklearn.metrics import classification_report\n",
    "from imutils import paths\n",
    "import matplotlib.pyplot as plt\n",
    "import numpy as np\n",
    "import os"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "fancy-signal",
   "metadata": {},
   "outputs": [],
   "source": [
    "# initialize the initial learning rate, number of epochs to train for,\n",
    "# and batch size\n",
    "INIT_LR = 1e-4\n",
    "EPOCHS = 20\n",
    "BS = 32"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "verbal-sierra",
   "metadata": {},
   "outputs": [],
   "source": [
    "DIRECTORY = r\"C:\\Users\\vibhu\\Downloads\\Face-Mask-Detection-master\\Face-Mask-Detection-master\\dataset\"\n",
    "CATEGORIES = [\"with_mask\", \"without_mask\"]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "disabled-criminal",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[INFO] loading images...\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "c:\\users\\vibhu\\appdata\\local\\programs\\python\\python37\\lib\\site-packages\\PIL\\Image.py:963: UserWarning: Palette images with Transparency expressed in bytes should be converted to RGBA images\n",
      "  \"Palette images with Transparency expressed in bytes should be \"\n"
     ]
    }
   ],
   "source": [
    "# grab the list of images in our dataset directory, then initialize\n",
    "# the list of data (i.e., images) and class images\n",
    "print(\"[INFO] loading images...\")\n",
    "\n",
    "data = []\n",
    "labels = []\n",
    "\n",
    "for category in CATEGORIES:\n",
    "    path = os.path.join(DIRECTORY, category)\n",
    "    for img in os.listdir(path):\n",
    "    \timg_path = os.path.join(path, img)\n",
    "    \timage = load_img(img_path, target_size=(224, 224))\n",
    "    \timage = img_to_array(image)\n",
    "    \timage = preprocess_input(image)\n",
    "\n",
    "    \tdata.append(image)\n",
    "    \tlabels.append(category)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "ethical-incidence",
   "metadata": {},
   "outputs": [],
   "source": [
    "# perform one-hot encoding on the labels\n",
    "lb = LabelBinarizer()\n",
    "labels = lb.fit_transform(labels)\n",
    "labels = to_categorical(labels)\n",
    "\n",
    "data = np.array(data, dtype=\"float32\")\n",
    "labels = np.array(labels)\n",
    "\n",
    "(trainX, testX, trainY, testY) = train_test_split(data, labels,\n",
    "\ttest_size=0.20, stratify=labels, random_state=42)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "sublime-startup",
   "metadata": {},
   "outputs": [],
   "source": [
    "# construct the training image generator for data augmentation\n",
    "aug = ImageDataGenerator(\n",
    "\trotation_range=20,\n",
    "\tzoom_range=0.15,\n",
    "\twidth_shift_range=0.2,\n",
    "\theight_shift_range=0.2,\n",
    "\tshear_range=0.15,\n",
    "\thorizontal_flip=True,\n",
    "\tfill_mode=\"nearest\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "deluxe-video",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "WARNING:tensorflow:`input_shape` is undefined or non-square, or `rows` is not in [96, 128, 160, 192, 224]. Weights for input shape (224, 224) will be loaded as the default.\n",
      "Downloading data from https://storage.googleapis.com/tensorflow/keras-applications/mobilenet_v2/mobilenet_v2_weights_tf_dim_ordering_tf_kernels_1.0_224_no_top.h5\n",
      "9412608/9406464 [==============================] - 1s 0us/step\n"
     ]
    }
   ],
   "source": [
    "# load the MobileNetV2 network, ensuring the head FC layer sets are\n",
    "# left off\n",
    "baseModel = MobileNetV2(weights=\"imagenet\", include_top=False,\n",
    "\tinput_tensor=Input(shape=(224, 224, 3)))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "colonial-frederick",
   "metadata": {},
   "outputs": [],
   "source": [
    "# construct the head of the model that will be placed on top of the\n",
    "# the base model\n",
    "headModel = baseModel.output\n",
    "headModel = AveragePooling2D(pool_size=(7, 7))(headModel)\n",
    "headModel = Flatten(name=\"flatten\")(headModel)\n",
    "headModel = Dense(128, activation=\"relu\")(headModel)\n",
    "headModel = Dropout(0.5)(headModel)\n",
    "headModel = Dense(2, activation=\"softmax\")(headModel)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "existing-disposal",
   "metadata": {},
   "outputs": [],
   "source": [
    "# place the head FC model on top of the base model (this will become\n",
    "# the actual model we will train)\n",
    "model = Model(inputs=baseModel.input, outputs=headModel)\n",
    "\n",
    "# loop over all layers in the base model and freeze them so they will\n",
    "# *not* be updated during the first training process\n",
    "for layer in baseModel.layers:\n",
    "\tlayer.trainable = False"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "clean-baseline",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[INFO] compiling model...\n"
     ]
    }
   ],
   "source": [
    "# compile our model\n",
    "print(\"[INFO] compiling model...\")\n",
    "opt = Adam(lr=INIT_LR, decay=INIT_LR / EPOCHS)\n",
    "model.compile(loss=\"binary_crossentropy\", optimizer=opt,\n",
    "\tmetrics=[\"accuracy\"])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "mechanical-terrorist",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[INFO] training head...\n",
      "Epoch 1/20\n",
      "95/95 [==============================] - 86s 909ms/step - loss: 0.3926 - accuracy: 0.8273 - val_loss: 0.0918 - val_accuracy: 0.9804\n",
      "Epoch 2/20\n",
      "95/95 [==============================] - 87s 916ms/step - loss: 0.1246 - accuracy: 0.9578 - val_loss: 0.0565 - val_accuracy: 0.9844\n",
      "Epoch 3/20\n",
      "95/95 [==============================] - 86s 908ms/step - loss: 0.0802 - accuracy: 0.9693 - val_loss: 0.0398 - val_accuracy: 0.9909\n",
      "Epoch 4/20\n",
      "95/95 [==============================] - 87s 913ms/step - loss: 0.0726 - accuracy: 0.9759 - val_loss: 0.0354 - val_accuracy: 0.9883\n",
      "Epoch 5/20\n",
      "95/95 [==============================] - 89s 936ms/step - loss: 0.0555 - accuracy: 0.9826 - val_loss: 0.0316 - val_accuracy: 0.9909\n",
      "Epoch 6/20\n",
      "95/95 [==============================] - 88s 927ms/step - loss: 0.0581 - accuracy: 0.9796 - val_loss: 0.0299 - val_accuracy: 0.9922\n",
      "Epoch 7/20\n",
      "95/95 [==============================] - 88s 927ms/step - loss: 0.0419 - accuracy: 0.9871 - val_loss: 0.0279 - val_accuracy: 0.9922\n",
      "Epoch 8/20\n",
      "95/95 [==============================] - 87s 911ms/step - loss: 0.0398 - accuracy: 0.9878 - val_loss: 0.0355 - val_accuracy: 0.9909\n",
      "Epoch 9/20\n",
      "95/95 [==============================] - 85s 897ms/step - loss: 0.0339 - accuracy: 0.9904 - val_loss: 0.0250 - val_accuracy: 0.9935\n",
      "Epoch 10/20\n",
      "95/95 [==============================] - 86s 901ms/step - loss: 0.0348 - accuracy: 0.9878 - val_loss: 0.0253 - val_accuracy: 0.9935\n",
      "Epoch 11/20\n",
      "95/95 [==============================] - 85s 898ms/step - loss: 0.0349 - accuracy: 0.9898 - val_loss: 0.0229 - val_accuracy: 0.9909\n",
      "Epoch 12/20\n",
      "95/95 [==============================] - 86s 906ms/step - loss: 0.0330 - accuracy: 0.9878 - val_loss: 0.0252 - val_accuracy: 0.9935\n",
      "Epoch 13/20\n",
      "95/95 [==============================] - 85s 896ms/step - loss: 0.0307 - accuracy: 0.9908 - val_loss: 0.0226 - val_accuracy: 0.9922\n",
      "Epoch 14/20\n",
      "95/95 [==============================] - 85s 899ms/step - loss: 0.0327 - accuracy: 0.9871 - val_loss: 0.0333 - val_accuracy: 0.9909\n",
      "Epoch 15/20\n",
      "95/95 [==============================] - 85s 897ms/step - loss: 0.0235 - accuracy: 0.9921 - val_loss: 0.0251 - val_accuracy: 0.9935\n",
      "Epoch 16/20\n",
      "95/95 [==============================] - 84s 879ms/step - loss: 0.0275 - accuracy: 0.9911 - val_loss: 0.0214 - val_accuracy: 0.9935\n",
      "Epoch 17/20\n",
      "95/95 [==============================] - 8533s 90s/step - loss: 0.0204 - accuracy: 0.9934 - val_loss: 0.0256 - val_accuracy: 0.9922\n",
      "Epoch 18/20\n",
      "95/95 [==============================] - 112s 1s/step - loss: 0.0278 - accuracy: 0.9914 - val_loss: 0.0224 - val_accuracy: 0.9935\n",
      "Epoch 19/20\n",
      "95/95 [==============================] - 135s 1s/step - loss: 0.0266 - accuracy: 0.9904 - val_loss: 0.0231 - val_accuracy: 0.9935\n",
      "Epoch 20/20\n",
      "95/95 [==============================] - 130s 1s/step - loss: 0.0253 - accuracy: 0.9918 - val_loss: 0.0211 - val_accuracy: 0.9935\n"
     ]
    }
   ],
   "source": [
    "# train the head of the network\n",
    "print(\"[INFO] training head...\")\n",
    "H = model.fit(\n",
    "\taug.flow(trainX, trainY, batch_size=BS),\n",
    "\tsteps_per_epoch=len(trainX) // BS,\n",
    "\tvalidation_data=(testX, testY),\n",
    "\tvalidation_steps=len(testX) // BS,\n",
    "\tepochs=EPOCHS)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "crucial-present",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[INFO] evaluating network...\n"
     ]
    }
   ],
   "source": [
    "# make predictions on the testing set\n",
    "print(\"[INFO] evaluating network...\")\n",
    "predIdxs = model.predict(testX, batch_size=BS)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "worthy-reply",
   "metadata": {},
   "outputs": [],
   "source": [
    "# for each image in the testing set we need to find the index of the\n",
    "# label with corresponding largest predicted probability\n",
    "predIdxs = np.argmax(predIdxs, axis=1)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "regional-arabic",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "              precision    recall  f1-score   support\n",
      "\n",
      "   with_mask       0.99      0.99      0.99       383\n",
      "without_mask       0.99      0.99      0.99       384\n",
      "\n",
      "    accuracy                           0.99       767\n",
      "   macro avg       0.99      0.99      0.99       767\n",
      "weighted avg       0.99      0.99      0.99       767\n",
      "\n",
      "[INFO] saving mask detector model...\n"
     ]
    }
   ],
   "source": [
    "# show a nicely formatted classification report\n",
    "print(classification_report(testY.argmax(axis=1), predIdxs,\n",
    "\ttarget_names=lb.classes_))\n",
    "\n",
    "# serialize the model to disk\n",
    "print(\"[INFO] saving mask detector model...\")\n",
    "model.save(\"mask_detector.model\", save_format=\"h5\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "furnished-cameroon",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAYUAAAEaCAYAAAD+E0veAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjEsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+j8jraAAAgAElEQVR4nOzdd5wV5dnw8d+U07bB7tlGWVAQqTZYBZFQZEEFu6gxikoxGkzMa4xGFB/0iSBBCZZoREGIaIxGSaz4AEpTYkQpIjYwQNBl2cbCtlPnfv84u4c9bDvbF/b6fjif6WeumT3MNTP3zH1rSimFEEIIAehtHYAQQoj2Q5KCEEKIMEkKQgghwiQpCCGECJOkIIQQIkySghBCiDBJCiJq69atQ9M0fvjhhwYtp2kaL730UgtF1XGNHj2a6dOnt3UY4gQjSeEEpGlanZ+TTjqpUd87fPhwDhw4QNeuXRu03IEDB5g0aVKj1tlQkoBq9stf/hLDMHjyySfbOhTRzklSOAEdOHAg/HnzzTcB+PTTT8PjNm/eHDG/z+eL6nvtdjvp6enoesN+Nunp6TidzgYtI5pPWVkZL730Evfddx/PPfdcW4cDRP+bE61PksIJKD09PfxJSkoCICUlJTwuNTWVJ598kp/97Gd06tSJ66+/HoD777+f/v37ExMTQ0ZGBrfddhuHDx8Of++xt48qh1evXs3IkSOJiYlhwIAB/N///V9EPMeevWuaxjPPPMPkyZOJj48nIyOD+fPnRyxTUFDA1VdfTWxsLGlpaTzwwAPcdNNNZGVlNWnf/OUvf2HAgAE4HA66d+/OrFmzCAQC4ekfffQR5513HvHx8cTHx3PGGWdEbM/cuXPp1asXDoeDlJQULrjgAsrLy2td31//+leGDh1Kp06dSE5OZuLEiXz33Xfh6Xv37kXTNF577TUuueQSYmJi6NWrF8uXL4/4nn379nHhhRficrno0aMHTz31VNTb/Oqrr9K7d29mzZpFdnY2mzZtqnGeIUOG4HQ6cbvdXHTRRRw6dCg8/emnnw7vt9TU1Igrv5NOOomHH3444vumT5/O6NGjw8OjR49m2rRpPPDAA3Tp0oVu3bpFtX8AcnNzmTJlCmlpaTidTvr27csLL7yAZVn06tWLuXPnRsxfWlpKQkICy5Yti3ofiaMkKXRQDz30EOeeey5btmxhzpw5ALhcLp577jm++uorli1bxrp167jjjjvq/a7f/va33HfffWzfvp3MzEyuvfZaioqK6l3/yJEj2bZtG3fffTe/+93vWLt2bXj6lClT2L59O++88w4ffvghP/zwA//85z+btM3vvvsuU6dOZfLkyezYsYMFCxbw9NNP89BDDwEQDAa59NJLGTp0KFu2bGHLli08+OCDxMTEALBixQrmzZvHE088wa5du1i9ejUXXXRRnev0er088MADbNmyhdWrV2MYBhMnTqx2pnzvvfcyefJkvvjiC6655hqmTJnCrl27AFBKccUVV1BQUMC6det46623eOutt9iyZUtU271o0SJuuukmHA4HP/3pT6tdLSxdupQbbriByy+/nC1btrB27VouvPBCgsEgALNnz+Z3v/sdM2bMYMeOHbz//vuceeaZUa27qtdee428vDw++OADPvzww6j2T3l5OaNGjWL79u28/PLLfPXVVzz11FPExMSg6zq33HILS5YsoWptPX/729/QdZ1rrrmmwTEKQIkT2saNGxWg9uzZEx4HqKlTp9a77IoVK5TdblfBYFAppdTatWsVoPbv3x8x/MYbb4SXOXDggALU+++/H7G+5cuXRwz/6le/ilhX37591b333quUUuq7775TgFqzZk14us/nU927d1djx46tM+Zj11XViBEj1NVXXx0x7vHHH1dOp1N5vV5VWFioALV27doal//jH/+o+vTpo3w+X50x1KWgoEAB6qOPPlJKKbVnzx4FqAULFoTn8fv9KjY2Vj377LNKKaVWr16tAPXtt9+G58nNzVVOp1NNmzatzvVt27ZN2Ww2lZubq5RS6t///rdyuVzq0KFD4XkyMjLU7bffXuPyJSUlyul0qkcffbTWdfTs2VP9/ve/jxg3bdo0NWrUqPDwqFGjVJ8+fcK/pdocu38WL16sHA5H+Dd3rJycHGWz2dTq1avD44YNG6ZmzJhR53pE7eRKoYM655xzqo1bsWIFI0eOpGvXrsTFxXH99dfj8/nIycmp87uqnjWmp6djGAYHDx6MehmAbt26hZf56quvABg2bFh4us1mIzMzs+6NqsfOnTsZOXJkxLhRo0bh8Xj4/vvvSUxMZPr06VxwwQVcdNFFzJs3j2+//TY87zXXXIPf76dnz57cfPPNLF++nOLi4jrXuW3bNq644gpO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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# plot the training loss and accuracy\n",
    "N = EPOCHS\n",
    "plt.style.use(\"ggplot\")\n",
    "plt.figure()\n",
    "plt.plot(np.arange(0, N), H.history[\"loss\"], label=\"train_loss\")\n",
    "plt.plot(np.arange(0, N), H.history[\"val_loss\"], label=\"val_loss\")\n",
    "plt.plot(np.arange(0, N), H.history[\"accuracy\"], label=\"train_acc\")\n",
    "plt.plot(np.arange(0, N), H.history[\"val_accuracy\"], label=\"val_acc\")\n",
    "plt.title(\"Training Loss and Accuracy\")\n",
    "plt.xlabel(\"Epoch #\")\n",
    "plt.ylabel(\"Loss/Accuracy\")\n",
    "plt.legend(loc=\"lower left\")\n",
    "plt.savefig(\"plot.png\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "authorized-blowing",
   "metadata": {},
   "outputs": [],
   "source": [
    "# import the necessary packages\n",
    "from tensorflow.keras.applications.mobilenet_v2 import preprocess_input\n",
    "from tensorflow.keras.preprocessing.image import img_to_array\n",
    "from tensorflow.keras.models import load_model\n",
    "from imutils.video import VideoStream\n",
    "import numpy as np\n",
    "import imutils\n",
    "import time\n",
    "import cv2\n",
    "import os\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "institutional-tolerance",
   "metadata": {},
   "outputs": [],
   "source": [
    "def detect_and_predict_mask(frame, faceNet, maskNet):\n",
    "\t# grab the dimensions of the frame and then construct a blob\n",
    "\t# from it\n",
    "\t(h, w) = frame.shape[:2]\n",
    "\tblob = cv2.dnn.blobFromImage(frame, 1.0, (224, 224),\n",
    "\t\t(104.0, 177.0, 123.0))\n",
    "\n",
    "\t# pass the blob through the network and obtain the face detections\n",
    "\tfaceNet.setInput(blob)\n",
    "\tdetections = faceNet.forward()\n",
    "\tprint(detections.shape)\n",
    "\n",
    "\t# initialize our list of faces, their corresponding locations,\n",
    "\t# and the list of predictions from our face mask network\n",
    "\tfaces = []\n",
    "\tlocs = []\n",
    "\tpreds = []\n",
    "\n",
    "\t# loop over the detections\n",
    "\tfor i in range(0, detections.shape[2]):\n",
    "\t\t# extract the confidence (i.e., probability) associated with\n",
    "\t\t# the detection\n",
    "\t\tconfidence = detections[0, 0, i, 2]\n",
    "\n",
    "\t\t# filter out weak detections by ensuring the confidence is\n",
    "\t\t# greater than the minimum confidence\n",
    "\t\tif confidence > 0.5:\n",
    "\t\t\t# compute the (x, y)-coordinates of the bounding box for\n",
    "\t\t\t# the object\n",
    "\t\t\tbox = detections[0, 0, i, 3:7] * np.array([w, h, w, h])\n",
    "\t\t\t(startX, startY, endX, endY) = box.astype(\"int\")\n",
    "\n",
    "\t\t\t# ensure the bounding boxes fall within the dimensions of\n",
    "\t\t\t# the frame\n",
    "\t\t\t(startX, startY) = (max(0, startX), max(0, startY))\n",
    "\t\t\t(endX, endY) = (min(w - 1, endX), min(h - 1, endY))\n",
    "\n",
    "\t\t\t# extract the face ROI, convert it from BGR to RGB channel\n",
    "\t\t\t# ordering, resize it to 224x224, and preprocess it\n",
    "\t\t\tface = frame[startY:endY, startX:endX]\n",
    "\t\t\tface = cv2.cvtColor(face, cv2.COLOR_BGR2RGB)\n",
    "\t\t\tface = cv2.resize(face, (224, 224))\n",
    "\t\t\tface = img_to_array(face)\n",
    "\t\t\tface = preprocess_input(face)\n",
    "\n",
    "\t\t\t# add the face and bounding boxes to their respective\n",
    "\t\t\t# lists\n",
    "\t\t\tfaces.append(face)\n",
    "\t\t\tlocs.append((startX, startY, endX, endY))\n",
    "\n",
    "\t# only make a predictions if at least one face was detected\n",
    "\tif len(faces) > 0:\n",
    "\t\t# for faster inference we'll make batch predictions on *all*\n",
    "\t\t# faces at the same time rather than one-by-one predictions\n",
    "\t\t# in the above `for` loop\n",
    "\t\tfaces = np.array(faces, dtype=\"float32\")\n",
    "\t\tpreds = maskNet.predict(faces, batch_size=32)\n",
    "\n",
    "\t# return a 2-tuple of the face locations and their corresponding\n",
    "\t# locations\n",
    "\treturn (locs, preds)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "bibliographic-winner",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[INFO] starting video stream...\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n",
      "(1, 1, 200, 7)\n"
     ]
    }
   ],
   "source": [
    "# load our serialized face detector model from disk\n",
    "prototxtPath = r\"face_detector\\deploy.prototxt\"\n",
    "weightsPath = r\"face_detector\\res10_300x300_ssd_iter_140000.caffemodel\"\n",
    "faceNet = cv2.dnn.readNet(prototxtPath, weightsPath)\n",
    "\n",
    "# load the face mask detector model from disk\n",
    "maskNet = load_model(\"mask_detector.model\")\n",
    "\n",
    "# initialize the video stream\n",
    "print(\"[INFO] starting video stream...\")\n",
    "vs = VideoStream(src=0).start()\n",
    "\n",
    "# loop over the frames from the video stream\n",
    "while True:\n",
    "\t# grab the frame from the threaded video stream and resize it\n",
    "\t# to have a maximum width of 400 pixels\n",
    "\tframe = vs.read()\n",
    "\tframe = imutils.resize(frame, width=400)\n",
    "\n",
    "\t# detect faces in the frame and determine if they are wearing a\n",
    "\t# face mask or not\n",
    "\t(locs, preds) = detect_and_predict_mask(frame, faceNet, maskNet)\n",
    "\n",
    "\t# loop over the detected face locations and their corresponding\n",
    "\t# locations\n",
    "\tfor (box, pred) in zip(locs, preds):\n",
    "\t\t# unpack the bounding box and predictions\n",
    "\t\t(startX, startY, endX, endY) = box\n",
    "\t\t(mask, withoutMask) = pred\n",
    "\n",
    "\t\t# determine the class label and color we'll use to draw\n",
    "\t\t# the bounding box and text\n",
    "\t\tlabel = \"Mask\" if mask > withoutMask else \"No Mask\"\n",
    "\t\tcolor = (0, 255, 0) if label == \"Mask\" else (0, 0, 255)\n",
    "\n",
    "\t\t# include the probability in the label\n",
    "\t\tlabel = \"{}: {:.2f}%\".format(label, max(mask, withoutMask) * 100)\n",
    "\n",
    "\t\t# display the label and bounding box rectangle on the output\n",
    "\t\t# frame\n",
    "\t\tcv2.putText(frame, label, (startX, startY - 10),\n",
    "\t\t\tcv2.FONT_HERSHEY_SIMPLEX, 0.45, color, 2)\n",
    "\t\tcv2.rectangle(frame, (startX, startY), (endX, endY), color, 2)\n",
    "\n",
    "\t# show the output frame\n",
    "\tcv2.imshow(\"Frame\", frame)\n",
    "\tkey = cv2.waitKey(1) & 0xFF\n",
    "\n",
    "\t# if the `q` key was pressed, break from the loop\n",
    "\tif key == ord(\"q\"):\n",
    "\t\tbreak\n",
    "\n",
    "# do a bit of cleanup\n",
    "cv2.destroyAllWindows()\n",
    "vs.stop()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "judicial-patch",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.9"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
